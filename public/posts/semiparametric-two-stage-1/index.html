<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Andy Beck">
    <meta name="description" content="Andy Beck&#39;s personal website">
    <meta name="keywords" content="blog,developer,personal">

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Semiparametric Two-Stage Analysis - Introduction"/>
<meta name="twitter:description" content="This past fall I had the opportunity to take BIOSTAT880: Statistical Analysis with Missing Data. Although the course did cover a broad overview of different approaches to missing data analysis, we spent a decent amount of time covering various semiparametric approaches, from inverse probability weighting (IPW) and augmented IPW approaches to calibration-based approaches. This wasn’t my first taste of semiparametric inference, but it wasn’t a topic I felt entirely comfortable with, so for the term project I did for the course I choose to do a review of semiparametric approaches to the analysis of data from two-stage designs with a focus on applications to two-stage designs in genetics."/>

    <meta property="og:title" content="Semiparametric Two-Stage Analysis - Introduction" />
<meta property="og:description" content="This past fall I had the opportunity to take BIOSTAT880: Statistical Analysis with Missing Data. Although the course did cover a broad overview of different approaches to missing data analysis, we spent a decent amount of time covering various semiparametric approaches, from inverse probability weighting (IPW) and augmented IPW approaches to calibration-based approaches. This wasn’t my first taste of semiparametric inference, but it wasn’t a topic I felt entirely comfortable with, so for the term project I did for the course I choose to do a review of semiparametric approaches to the analysis of data from two-stage designs with a focus on applications to two-stage designs in genetics." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/semiparametric-two-stage-1/" />
<meta property="article:published_time" content="2019-12-13T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-12-13T00:00:00+00:00" />


    
      <base href="/posts/semiparametric-two-stage-1/">
    
    <title>
  Semiparametric Two-Stage Analysis - Introduction · Andy Beck
</title>

    
      <link rel="canonical" href="/posts/semiparametric-two-stage-1/">
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="/css/coder.min.546ce032528e98207b81dafb9bad28ea4de7b69a8c16f323d26fa30270bb591e.css" integrity="sha256-VGzgMlKOmCB7gdr7m60o6k3ntpqMFvMj0m&#43;jAnC7WR4=" crossorigin="anonymous" media="screen" />
    

    

    
      
        
        
        <link rel="stylesheet" href="/css/coder-inverted.min.460efa730895f842a1578b3c6a8133d45e356f95dca24f60f28689c1370b29c9.css" integrity="sha256-Rg76cwiV&#43;EKhV4s8aoEz1F41b5Xcok9g8oaJwTcLKck=" crossorigin="anonymous" media="screen" />
      
    

    

    
    
    <link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

    <meta name="generator" content="Hugo 0.58.3" />
  </head>

  <body class=" inverted">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="/">
      Andy Beck
    </a>
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="/about/">About</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/posts/">Blog</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/projects/">Projects</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/contact/">Contact me</a>
          </li>
        
      
      
    </ul>
  </section>
</nav>


      <div class="content">
        
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">Semiparametric Two-Stage Analysis - Introduction</h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fas fa-calendar"></i>
              <time datetime='2019-12-13T00:00:00Z'>
                December 13, 2019
              </time>
            </span>
            <span class="reading-time">
              <i class="fas fa-clock"></i>
              6 minutes read
            </span>
          </div>
          
          
        </div>
      </header>

      <div>
        


<p>This past fall I had the opportunity to take <a href="https://sph.umich.edu/academics/courses/course.php?courseID=BIOSTAT880">BIOSTAT880</a>: Statistical Analysis with Missing Data. Although the course did cover a broad overview of different approaches to missing data analysis, we spent a decent amount of time covering various semiparametric approaches, from inverse probability weighting (IPW) and augmented IPW approaches to <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.1002.7547&amp;rep=rep1&amp;type=pdf">calibration-based approaches</a>. This wasn’t my first taste of semiparametric inference, but it wasn’t a topic I felt entirely comfortable with, so for the term project I did for the course I choose to do a review of semiparametric approaches to the analysis of data from two-stage designs with a focus on applications to two-stage designs in genetics. I found the papers I read on the topic were incredibly interesting, so I figured that along with the term paper I’d also write a series blog post that covers the material in a more informal matter. First I’ll cover two-stage designs, with a particular emphasis on two-stage outcome-dependent designs.</p>
<div id="two-stage-designs" class="section level1">
<h1>Two-stage designs</h1>
<p>In a two-stage design, there is a first phase in which a sample is drawn from a population of interest, and then a smaller subsample is then sampled from this sample for further analysis in the second phase of a study. This is generally done when a measure of interest is expensive to acquire and there are cheaper/easier to acquire measures that are correlated with the expensive variable. <span class="citation">Neyman (<a href="#ref-neyman1938" role="doc-biblioref">1938</a>)</span> considered the situation where the outcome of interest was expensive to acquire (due to a long interview), but there were other variables that were both easier to acquire for a larger sample and were correlated with the outcome of interest. Here one strategy would be to collect information on the cheap covariates for a large sample and then do stratified sampling on this sample to chose who to measure the outcome on. He explored examples where this double sampling approach could be either helpful or not in terms of efficiency (as opposed to doing one simple random sample to measure the outcome), which depends on prior knowledge on the relationship between the covariates in the population.</p>
</div>
<div id="two-stage-outcome-dependent-designs" class="section level1">
<h1>Two-stage outcome dependent designs</h1>
<p>Sometimes the outcome of interest is easy to acquire, but it is postulated that there is a relationship between the outcome and a set of covariates that is expensive to acquire. To tie all of this to genetics, we can easily think of settings where we might have trait or disease measures on a large population that we think might have a genetic component, but it infeasible to genotype every subject. <span class="citation">White (<a href="#ref-white1982" role="doc-biblioref">1982</a>)</span> introduced the idea of a two-stage outcome-dependent design through the example of a rare-exposure/rare-disease study. In such a scenario, we might have a rare disease and rare exposure, and we might want to assess risk while controlling for other (discrete) covariates. To get reasonable estimates of risk in this scenario, a simple random sample from a population would have to be rather large in order to sample both enough cases and exposed individuals in each strata determined by the other covariates. This would lead to highly variable estimates of stratum-specific odds ratios and could potentially reduce power to detect a covariate-adjusted association between the disease and the risk factor. Here we’re interested in how the subjects are distributed into the strata based on their disease and exposure status, and collecting enough information on exposed subjects to do this in a simple random sample would entail sampling way more unexposed individuals than we’d need to do the same for them. <span class="citation">White (<a href="#ref-white1982" role="doc-biblioref">1982</a>)</span> proposed a two-stage approach in which during the first stage data are collected on exposure and disease status from a large sample. This sample can be represented in a 2x2 table:</p>
<center>
<table>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center"></th>
<th align="center">Disease</th>
<th align="center"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Exposure</td>
<td align="center"></td>
<td align="center">Y</td>
<td align="center">N</td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center">Y</td>
<td align="center"><span class="math inline">\(N_1\)</span></td>
<td align="center"><span class="math inline">\(N_2\)</span></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center">N</td>
<td align="center"><span class="math inline">\(N_3\)</span></td>
<td align="center"><span class="math inline">\(N_4\)</span></td>
</tr>
</tbody>
</table>
</center>
<p>In the second stage of the study separate random samples are taken from each of the cells, and these subjects have data on additional covariates measured. The suggestion made in <span class="citation">White (<a href="#ref-white1982" role="doc-biblioref">1982</a>)</span> is to over-sample from the smaller cells, the idea being that rarer observations are more informative. In the paper an example is given where the four cell counts are 50, 30, 250, and 270; the suggestion for a second stage sample of 400 subjects from this first sample is to take 50, 30, 160 and 160 individuals from the cells, respectively.</p>
<p><span class="citation">White (<a href="#ref-white1982" role="doc-biblioref">1982</a>)</span> lists two conditions for this two-stage approach to be advantageous over a simple random sample:</p>
<ol style="list-style-type: decimal">
<li>Small counts are expected for some groups/strata determined by the covariates of interest</li>
<li>The two-stage design would save money, meaning that collection of the disease/exposure status is cheaper than collecting the disease/exposure status and the other covariates in one pass.</li>
</ol>
<p>In generalizing this design to settings where the other covariates aren’t necessarily discrete, I’m under the impression that point 2 is what’s really put into consideration (I’m not entirely sure how point 1 would generalize outside of the above setting). Also, interest might be in evaluating the relationship between expensive covariates and continuous outcomes. In this case a suggestion for the sampling mechanism for the second stage is to employ an “extreme tails” approach where subjects with lower or higher than expected values of the trait of interest are selected for further measure. For example, in the following toy example where we’re interested in relating height to a set of expensive covariates, we might start with a sample with the following distribution:</p>
<p><img src="/posts/2019-12-13-semiparametric-two-stage-analysis_files/figure-html/fig1-1.png" width="960" /></p>
<p>If we were to employ an extreme-tails approach, we’d select subjects falling into either tail of the distribution, for example:</p>
<p><img src="/posts/2019-12-13-semiparametric-two-stage-analysis_files/figure-html/fig2-1.png" width="960" /></p>
<p>Note that we could do something similar but also account for other covariates and allow for an individually determined threshold; see <span class="citation">Bjørnland et al. (<a href="#ref-bjornland2018" role="doc-biblioref">2018</a>)</span>, for example.</p>
<p>Now that we’ve discussed what a two-stage outcome-dependent design might look like, we next look at how to analyze data while also accounting for the selection mechanism. Semiparametric approaches to this will be the subject of the next post in this series.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-bjornland2018">
<p>Bjørnland, Thea, Anja Bye, Einar Ryeng, Ulrik Wisløff, and Mette Langaas. 2018. “Powerful Extreme Phenotype Sampling Designs and Score Tests for Genetic Association Studies.” <em>Statistics in Medicine</em> 37 (28): 4234–51. <a href="https://doi.org/10.1002/sim.7914">https://doi.org/10.1002/sim.7914</a>.</p>
</div>
<div id="ref-neyman1938">
<p>Neyman, J. 1938. “Contribution to the Theory of Sampling Human Populations.” <em>Journal of the American Statistical Association</em> 33 (201): 101–16. <a href="https://doi.org/10.2307/2279117">https://doi.org/10.2307/2279117</a>.</p>
</div>
<div id="ref-white1982">
<p>White, J. E. 1982. “A Two Stage Design for the Study of the Relationship Between a Rare Exposure and a Rare Disease1.” <em>American Journal of Epidemiology</em> 115 (1): 119–28. <a href="https://doi.org/10.1093/oxfordjournals.aje.a113266">https://doi.org/10.1093/oxfordjournals.aje.a113266</a>.</p>
</div>
</div>
</div>

      </div>

      <footer>
        


        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "andysbiostatblog" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      </footer>
    </article>

      <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML-full">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
        TeX: { extensions: ["AMSmath.js", "AMSsymbols.js"] }
      }
    });
    MathJax.Hub.Queue(function() {
      
      
      
      var all = MathJax.Hub.getAllJax(), i;
      for(i = 0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  </script>


  </section>

      </div>

      <footer class="footer">
  <section class="container">
    
      <p>That's all!</p>
    
    
    
    
  </section>
</footer>

    </main>

    

  </body>

</html>
